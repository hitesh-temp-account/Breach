name: My test workflow

on:
  push:
    paths:
      - 'gradle.properties'

jobs:
  update-badge:
    runs-on: ubuntu-latest

    permissions:
      issues: write
#      contents: write
      pull-requests: write
    steps:
     - name: Checkout Repository
       uses: actions/checkout@v2

     - name: Set up Java
       uses: actions/setup-java@v2
       with:
          distribution: 'adopt'
          java-version: '11'

#     - name: Read Version Number
#       id: version
#       run: |
#            version=$(grep '^version' gradle.properties | cut -d= -f2 | tr -d '[:space:]')
#            echo "VERSION: $version"

     - name: Update README Badge
       run: |           
            version=$(grep '^version' gradle.properties | cut -d= -f2 | tr -d '[:space:]')
            echo "VERSION: $version"
            echo "badge\/version-v$version-blue.svg"
            sed -i "s/\(badge\/version-v[0-9]\.[0-9]-blue\.svg\)/badge\/version-v$version-blue.svg/" README.md
            cat README.md

     - name: Stash changes
       run: |
            git add .

     - name: Commit and Push Changes
       run: |
            git config user.name "${{ github.actor }}"
            git config user.email "${{ github.actor }}@users.noreply.github.com"
            git remote set-url origin "https://${{ secrets.ACTOR_TOKEN }}@github.com/${{ github.repository }}"
            git add README.md
            git commit -m "Update version badge [skip ci]"
            git push

### if: steps.git-check.outputs.changes_detected == 'true'
  





